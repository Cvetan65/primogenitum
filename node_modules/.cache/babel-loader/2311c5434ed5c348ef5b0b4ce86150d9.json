{"ast":null,"code":"var _jsxFileName = \"/home/cvetan/Documents/AKTUELNO/PrevozSemanticUI/prevoz-cist/src/features/events/eventDetailed/EventDetailedChat.jsx\";\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { Segment, Comment, Header } from 'semantic-ui-react';\nimport { firebaseObjectToArray, getEventChatRef } from '../../../app/firestore/firebaseService';\nimport { listenToEventChat } from '../eventActions';\nimport EventDetailedChatForm from './EventDetailedChatForm';\nimport { formatDistance } from 'date-fns';\nimport { CLEAR_COMMENTS } from '../eventConstants';\nexport default function EventDetailedChat({\n  eventId\n}) {\n  const dispatch = useDispatch();\n  const {\n    comments\n  } = useSelector(state => state.event);\n  const [showReplyForm, setShowReplyForm] = useState({\n    open: false,\n    commentId: null\n  });\n\n  function handleCloseReplyForm() {\n    setShowReplyForm({\n      open: false,\n      comment: null\n    });\n  }\n\n  useEffect(() => {\n    getEventChatRef(eventId).on('value', snapshot => {\n      if (!snapshot.exists()) return;\n      dispatch(listenToEventChat(firebaseObjectToArray(snapshot.val()).reverse()));\n    });\n    return () => {\n      dispatch({\n        type: CLEAR_COMMENTS\n      });\n      getEventChatRef().off();\n    };\n  }, [eventId, dispatch]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Segment, {\n    textAlign: \"center\",\n    attached: \"top\",\n    inverted: true,\n    color: \"teal\",\n    style: {\n      border: 'none'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 9\n    }\n  }, \"Chat about this event\")), /*#__PURE__*/React.createElement(Segment, {\n    attached: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(EventDetailedChatForm, {\n    eventId: eventId,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Comment.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 9\n    }\n  }, comments.map(comment => /*#__PURE__*/React.createElement(Comment, {\n    key: comment.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Comment.Avatar, {\n    src: comment.photoURL || '/assets/user.png',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Comment.Content, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Comment.Author, {\n    as: Link,\n    to: `/profile/${comment.uid}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 15\n    }\n  }, comment.displayName), /*#__PURE__*/React.createElement(Comment.Metadata, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 17\n    }\n  }, formatDistance(comment.date, new Date()))), /*#__PURE__*/React.createElement(Comment.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 15\n    }\n  }, comment.text.split('\\n').map((text, i) => /*#__PURE__*/React.createElement(\"span\", {\n    key: i,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 17\n    }\n  }, text, /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 19\n    }\n  })))), /*#__PURE__*/React.createElement(Comment.Actions, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Comment.Action, {\n    onClick: () => setShowReplyForm({\n      o\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 17\n    }\n  }, \"\\u041E\\u0434\\u0433\\u043E\\u0432\\u043E\\u0440\\u0438\"), showReplyForm.open && /*#__PURE__*/React.createElement(EventDetailedChatForm, {\n    eventId: eventId,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 17\n    }\n  }))))))));\n}","map":{"version":3,"sources":["/home/cvetan/Documents/AKTUELNO/PrevozSemanticUI/prevoz-cist/src/features/events/eventDetailed/EventDetailedChat.jsx"],"names":["React","useEffect","useState","useDispatch","useSelector","Link","Segment","Comment","Header","firebaseObjectToArray","getEventChatRef","listenToEventChat","EventDetailedChatForm","formatDistance","CLEAR_COMMENTS","EventDetailedChat","eventId","dispatch","comments","state","event","showReplyForm","setShowReplyForm","open","commentId","handleCloseReplyForm","comment","on","snapshot","exists","val","reverse","type","off","border","map","id","photoURL","uid","displayName","date","Date","text","split","i","o"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { Segment, Comment, Header } from 'semantic-ui-react';\nimport { firebaseObjectToArray, getEventChatRef } from '../../../app/firestore/firebaseService';\nimport { listenToEventChat } from '../eventActions';\nimport EventDetailedChatForm from './EventDetailedChatForm';\nimport {formatDistance} from 'date-fns'\nimport { CLEAR_COMMENTS } from '../eventConstants';\n\nexport default function EventDetailedChat({eventId}) {\n const dispatch = useDispatch();\n const {comments} = useSelector(state => state.event)\n const [showReplyForm, setShowReplyForm] = useState({open: false, commentId: null});\n\n function handleCloseReplyForm() {\n   setShowReplyForm({open: false, comment: null})\n }\n\nuseEffect(() =>{\n  getEventChatRef(eventId).on('value', snapshot => {\n    if (!snapshot.exists()) return;\n   dispatch(listenToEventChat(firebaseObjectToArray(snapshot.val()).reverse()));\n  });\n  return () =>  {\n    dispatch({type: CLEAR_COMMENTS});\n    getEventChatRef().off();\n  }\n},[eventId, dispatch])\n\n  return (\n    <>\n      <Segment\n        textAlign='center'\n        attached='top'\n        inverted\n        color='teal'\n        style={{ border: 'none' }}\n      >\n        <Header>Chat about this event</Header>\n      </Segment>\n\n      <Segment attached>\n      <EventDetailedChatForm eventId={eventId} />\n        <Comment.Group>\n          {comments.map(comment => (\n            <Comment key={comment.id}>\n            <Comment.Avatar src={comment.photoURL || '/assets/user.png'} />\n            <Comment.Content>\n              <Comment.Author as={Link} to={`/profile/${comment.uid}`} >{comment.displayName}</Comment.Author>\n              <Comment.Metadata>\n                <div>{formatDistance(comment.date, new Date())}</div>\n              </Comment.Metadata>\n              <Comment.Text>{comment.text.split('\\n').map((text, i) => (\n                <span key={i} >\n                  {text} \n                  <br />\n                </span>\n              ))}</Comment.Text>\n              <Comment.Actions>\n                <Comment.Action onClick={() =>  setShowReplyForm({o})} >Одговори</Comment.Action>\n                {showReplyForm.open && \n                <EventDetailedChatForm eventId={eventId} />\n                }\n              </Comment.Actions>\n            </Comment.Content>\n          </Comment>\n          ))}\n          \n        </Comment.Group>\n       \n      </Segment>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}