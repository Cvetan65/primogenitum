{"ast":null,"code":"import { SIGN_IN_USER, SIGN_OUT_USER } from './authConstants';\nimport { APP_LOADED } from '../../app/async/asyncReducer';\nimport firebase from '../../app/config/firebase';\nimport { getUserProfile, dataFromSnapshot } from '../../app/firestore/firestoreService';\nimport { listenToCurrentUserProfile } from '../profiles/profileActions';\nexport function signInUser(user) {\n  return {\n    type: SIGN_IN_USER,\n    payload: user\n  };\n}\nexport function verifyAuth() {\n  return function (dispatch) {\n    return firebase.auth().onAuthStateChanged(user => {\n      if (user) {\n        dispatch(signInUser(user));\n        const profileRef = getUserProfile(user.uid);\n        profileRef.onSnapshot(snapshot => {\n          dispatch(listenToCurrentUserProfile(dataFromSnapshot(snapshot)));\n          dispatch({\n            type: APP_LOADED\n          });\n        });\n      } else {\n        dispatch(signOutUser());\n        dispatch({\n          type: APP_LOADED\n        });\n      }\n    });\n  };\n}\nexport function signOutUser() {\n  return {\n    type: SIGN_OUT_USER\n  };\n}","map":{"version":3,"sources":["/home/cvetan/Documents/AKTUELNO/revents-master-14/cista/revents-4a7a2c1fc0de9971a68b4bb68ad6fa71370a6c80/src/features/auth/authActions.js"],"names":["SIGN_IN_USER","SIGN_OUT_USER","APP_LOADED","firebase","getUserProfile","dataFromSnapshot","listenToCurrentUserProfile","signInUser","user","type","payload","verifyAuth","dispatch","auth","onAuthStateChanged","profileRef","uid","onSnapshot","snapshot","signOutUser"],"mappings":"AAAA,SAASA,YAAT,EAAuBC,aAAvB,QAA4C,iBAA5C;AACA,SAAQC,UAAR,QAAyB,8BAAzB;AACA,OAAOC,QAAP,MAAqB,2BAArB;AACA,SAASC,cAAT,EAAyBC,gBAAzB,QAAiD,sCAAjD;AACA,SAASC,0BAAT,QAA2C,4BAA3C;AAEA,OAAO,SAASC,UAAT,CAAoBC,IAApB,EAA0B;AAC/B,SAAO;AACHC,IAAAA,IAAI,EAAET,YADH;AAEHU,IAAAA,OAAO,EAAEF;AAFN,GAAP;AAID;AAED,OAAO,SAASG,UAAT,GAAsB;AACzB,SAAO,UAAUC,QAAV,EAAoB;AACvB,WAAOT,QAAQ,CAACU,IAAT,GAAgBC,kBAAhB,CAAmCN,IAAI,IAAI;AAC9C,UAAIA,IAAJ,EAAU;AACNI,QAAAA,QAAQ,CAACL,UAAU,CAACC,IAAD,CAAX,CAAR;AACA,cAAMO,UAAU,GAAGX,cAAc,CAACI,IAAI,CAACQ,GAAN,CAAjC;AACAD,QAAAA,UAAU,CAACE,UAAX,CAAsBC,QAAQ,IAAI;AAChCN,UAAAA,QAAQ,CAACN,0BAA0B,CAACD,gBAAgB,CAACa,QAAD,CAAjB,CAA3B,CAAR;AACAN,UAAAA,QAAQ,CAAC;AAACH,YAAAA,IAAI,EAAEP;AAAP,WAAD,CAAR;AACD,SAHD;AAIH,OAPD,MAOO;AACHU,QAAAA,QAAQ,CAACO,WAAW,EAAZ,CAAR;AACAP,QAAAA,QAAQ,CAAC;AAACH,UAAAA,IAAI,EAAEP;AAAP,SAAD,CAAR;AACH;AACJ,KAZM,CAAP;AAaH,GAdD;AAeH;AAED,OAAO,SAASiB,WAAT,GAAuB;AAC5B,SAAO;AACLV,IAAAA,IAAI,EAAER;AADD,GAAP;AAGD","sourcesContent":["import { SIGN_IN_USER, SIGN_OUT_USER } from './authConstants';\nimport {APP_LOADED} from '../../app/async/asyncReducer';\nimport firebase from '../../app/config/firebase';\nimport { getUserProfile, dataFromSnapshot } from '../../app/firestore/firestoreService';\nimport { listenToCurrentUserProfile } from '../profiles/profileActions';\n\nexport function signInUser(user) {\n  return {\n      type: SIGN_IN_USER,\n      payload: user\n  }\n}\n\nexport function verifyAuth() {\n    return function (dispatch) {\n        return firebase.auth().onAuthStateChanged(user => {\n            if (user) {\n                dispatch(signInUser(user));\n                const profileRef = getUserProfile(user.uid);\n                profileRef.onSnapshot(snapshot => {\n                  dispatch(listenToCurrentUserProfile(dataFromSnapshot(snapshot)));\n                  dispatch({type: APP_LOADED})\n                })\n            } else {\n                dispatch(signOutUser())\n                dispatch({type: APP_LOADED})\n            }\n        })\n    }\n}\n\nexport function signOutUser() {\n  return {\n    type: SIGN_OUT_USER,\n  };\n}\n"]},"metadata":{},"sourceType":"module"}