{"ast":null,"code":"var _jsxFileName = \"/home/cvetan/Documents/AKTUELNO/revents-master-14/cista/revents-4a7a2c1fc0de9971a68b4bb68ad6fa71370a6c80/src/features/profiles/profilePage/PhotosTab.jsx\";\nimport React, { useState } from 'react';\nimport { Grid, Header, Button, Tab, Card, Image } from 'semantic-ui-react';\nimport PhotoUploadWidget from '../../../app/common/photos/PhotoUploadWidget';\nimport useFirestoreColection from '../../../app/hooks/useFirestoreCollection';\nimport { getUserPhotos, setMainPhoto, deletePhotoFromCollection } from '../../../app/firestore/firestoreService';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { listenToUserPhotos } from '../profileActions';\nimport { toast } from 'react-toastify';\nimport { deleteFromFirebaseStorage } from '../../../app/firestore/firebaseService';\nexport default function PhotosTab({\n  profile,\n  isCurrentUser\n}) {\n  const dispatch = useDispatch();\n  const [editMode, setEditMode] = useState(false);\n  const {\n    loading\n  } = useSelector(state => state.async);\n  const {\n    photos\n  } = useSelector(state => state.profile);\n  const [updating, setUpdating] = useState({\n    isUpdating: false,\n    target: null\n  });\n  const [deleting, setDeleting] = useState({\n    isDeleting: false,\n    target: null\n  });\n  useFirestoreColection({\n    query: () => getUserPhotos(profile.id),\n    data: photos => dispatch(listenToUserPhotos(photos)),\n    deps: [profile.id, dispatch]\n  });\n\n  async function handleSetMainPhoto(photo, target) {\n    setUpdating({\n      isUpdating: true,\n      target\n    });\n\n    try {\n      await setMainPhoto(photo);\n    } catch (error) {\n      toast.error(error.message);\n    } finally {\n      setUpdating({\n        isUpdating: false,\n        target: null\n      });\n    }\n  }\n\n  async function handleDeletePhoto(photo, target) {\n    setDeleting({\n      isDeleting: true,\n      target\n    });\n\n    try {\n      await deleteFromFirebaseStorage(photo.name);\n      await deletePhotoFromCollection(photo.id);\n    } catch (error) {\n      toast.error(error.message);\n    } finally {\n      setDeleting({\n        isDeleting: false,\n        target: null\n      });\n    }\n  }\n\n  return /*#__PURE__*/React.createElement(Tab.Pane, {\n    loading: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Grid.Column, {\n    width: 16,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    floated: \"left\",\n    icon: \"user\",\n    content: `Photos`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 11\n    }\n  }), isCurrentUser && /*#__PURE__*/React.createElement(Button, {\n    onClick: () => setEditMode(!editMode),\n    floated: \"right\",\n    basic: true,\n    content: editMode ? 'Cancel' : 'Add Photo',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Grid.Column, {\n    width: 16,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 9\n    }\n  }, editMode ? /*#__PURE__*/React.createElement(PhotoUploadWidget, {\n    setEditMode: setEditMode,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 13\n    }\n  }) : /*#__PURE__*/React.createElement(Card.Group, {\n    itemsPerRow: 5,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }\n  }, photos.map(photo => /*#__PURE__*/React.createElement(Card, {\n    key: photo.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Image, {\n    src: photo.url,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(Button.Group, {\n    fluid: true,\n    widths: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    name: photo.id,\n    loading: updating.isUpdating && updating.target === photo.id,\n    onClick: e => handleSetMainPhoto(photo, e.target.name),\n    disabled: photo.url === profile.photoURL,\n    basic: true,\n    color: \"green\",\n    icon: \"angle up\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    name: photo.id,\n    onClick: e => handleDeletePhoto(photo, e.target.name),\n    loading: deleting.isDeleting && deleting.target === photo.id,\n    disabled: photo.url === profile.photoURL,\n    basic: true,\n    color: \"red\",\n    icon: \"trash\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 21\n    }\n  }))))))));\n}","map":{"version":3,"sources":["/home/cvetan/Documents/AKTUELNO/revents-master-14/cista/revents-4a7a2c1fc0de9971a68b4bb68ad6fa71370a6c80/src/features/profiles/profilePage/PhotosTab.jsx"],"names":["React","useState","Grid","Header","Button","Tab","Card","Image","PhotoUploadWidget","useFirestoreColection","getUserPhotos","setMainPhoto","deletePhotoFromCollection","useDispatch","useSelector","listenToUserPhotos","toast","deleteFromFirebaseStorage","PhotosTab","profile","isCurrentUser","dispatch","editMode","setEditMode","loading","state","async","photos","updating","setUpdating","isUpdating","target","deleting","setDeleting","isDeleting","query","id","data","deps","handleSetMainPhoto","photo","error","message","handleDeletePhoto","name","map","url","e","photoURL"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { Grid, Header, Button, Tab, Card, Image } from 'semantic-ui-react';\nimport PhotoUploadWidget from '../../../app/common/photos/PhotoUploadWidget';\nimport useFirestoreColection from '../../../app/hooks/useFirestoreCollection';\nimport {\n  getUserPhotos,\n  setMainPhoto,\n  deletePhotoFromCollection,\n} from '../../../app/firestore/firestoreService';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { listenToUserPhotos } from '../profileActions';\nimport { toast } from 'react-toastify';\nimport { deleteFromFirebaseStorage } from '../../../app/firestore/firebaseService';\n\nexport default function PhotosTab({ profile, isCurrentUser }) {\n  const dispatch = useDispatch();\n  const [editMode, setEditMode] = useState(false);\n  const { loading } = useSelector((state) => state.async);\n  const { photos } = useSelector((state) => state.profile);\n  const [updating, setUpdating] = useState({ isUpdating: false, target: null });\n  const [deleting, setDeleting] = useState({ isDeleting: false, target: null });\n\n  useFirestoreColection({\n    query: () => getUserPhotos(profile.id),\n    data: (photos) => dispatch(listenToUserPhotos(photos)),\n    deps: [profile.id, dispatch],\n  });\n\n  async function handleSetMainPhoto(photo, target) {\n    setUpdating({ isUpdating: true, target });\n    try {\n      await setMainPhoto(photo);\n    } catch (error) {\n      toast.error(error.message);\n    } finally {\n      setUpdating({ isUpdating: false, target: null });\n    }\n  }\n\n  async function handleDeletePhoto(photo, target) {\n    setDeleting({ isDeleting: true, target });\n    try {\n      await deleteFromFirebaseStorage(photo.name);\n      await deletePhotoFromCollection(photo.id);\n    } catch (error) {\n      toast.error(error.message);\n    } finally {\n      setDeleting({ isDeleting: false, target: null });\n    }\n  }\n\n  return (\n    <Tab.Pane loading={loading}>\n      <Grid>\n        <Grid.Column width={16}>\n          <Header floated='left' icon='user' content={`Photos`} />\n          {isCurrentUser && (\n            <Button\n              onClick={() => setEditMode(!editMode)}\n              floated='right'\n              basic\n              content={editMode ? 'Cancel' : 'Add Photo'}\n            />\n          )}\n        </Grid.Column>\n        <Grid.Column width={16}>\n          {editMode ? (\n            <PhotoUploadWidget setEditMode={setEditMode} />\n          ) : (\n            <Card.Group itemsPerRow={5}>\n              {photos.map((photo) => (\n                <Card key={photo.id}>\n                  <Image src={photo.url} />\n                  <Button.Group fluid widths={2}>\n                    <Button\n                      name={photo.id}\n                      loading={\n                        updating.isUpdating && updating.target === photo.id\n                      }\n                      onClick={(e) => handleSetMainPhoto(photo, e.target.name)}\n                      disabled={photo.url === profile.photoURL}\n                      basic\n                      color='green'\n                      icon='angle up'\n                    />\n                    <Button\n                      name={photo.id}\n                      onClick={(e) => handleDeletePhoto(photo, e.target.name)}\n                      loading={deleting.isDeleting && deleting.target === photo.id}\n                      disabled={photo.url === profile.photoURL}\n                      basic\n                      color='red'\n                      icon='trash'\n                    />\n                  </Button.Group>\n                </Card>\n              ))}\n            </Card.Group>\n          )}\n        </Grid.Column>\n      </Grid>\n    </Tab.Pane>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}